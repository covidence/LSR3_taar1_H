ifelse(population=="Parkinson Disease Psychosis", 2, 3),
meta_outcome_soe<-meta_outcome %>%
mutate(TE=ifelse(outcome=="serious" | outcome=="death", TE.fixed, TE.random),
seTE=ifelse(outcome=="serious" | outcome=="death", seTE.fixed, seTE.random),
TE.placebo=ifelse(outcome=="serious" | outcome=="death", TE.placebo.fixed, TE.placebo.random),
duration=ifelse(duration=="0.14-0.14", "1 day",
ifelse(duration=="0.14-2", "1 day to 2 weeks",
ifelse(duration=="4-4", "4 weeks",
ifelse(duration=="4-6", "4-6 weeks",
ifelse(duration=="6-6", "6 weeks", NA)))))) %>%
mutate(outcome_type=ifelse(outcome %in% effic_outcomes, "efficacy", "other")) %>%
mutate(n_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 100,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 626,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1383,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 39,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 128,1550)))))) %>% #Added the negative symptom study too
mutate(k_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 2,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 12,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 4,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 1,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1,6)))))) %>%
mutate(k_prop=k/k_possible,
n_prop=ifelse(k_prop==1, 1, n/n_possible),
k_schiz_prop=k_schiz/k, n_schiz_prop=n_schiz/n,
moderate_to_high_bias_prop=(moderate_bias+high_bias)/k) %>%
mutate(TE_lb=TE-1.96*seTE,
TE_ub=TE+1.96*seTE) %>%
mutate(cer_point=exp(TE.placebo)/(1+exp(TE.placebo))) %>%
mutate(point=ifelse(sm=="OR", round(exp(TE), 2), round(TE, 2)),
lb=ifelse(sm=="OR", round(exp(TE_lb), 2), round(TE_lb, 2)),
ub=ifelse(sm=="OR", round(exp(TE_ub), 2), round(TE_ub, 2))) %>%
mutate(ACR=ifelse(sm=="OR", round(100*point*cer_point/(1-cer_point+point*cer_point),1), NA),
CER=ifelse(!is.na(point), round(100*cer_point, 1), NA),
t2=round(tau2,4)) %>%
mutate(association=ifelse(!is.na(point),
ifelse(k>1 & !is.na(t2), ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2)),
ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub))),
paste0("N=", k, " n=", n, "; not estimable effect size 0 events in both arms")),
study_limitations=ifelse(moderate_to_high_bias_prop==0 & k==1, "1 study with an overall low risk of bias",
ifelse(moderate_bias==1 & k==1, "1 study with overall some concerns in risk of bias",
ifelse(high_bias==1 & k==1, "1 study with overall high risk of bias",
ifelse(moderate_to_high_bias_prop==0 & k>1, " All studies had overall low risk of bias",
paste0(round(100*(1-moderate_to_high_bias_prop),1),"% had overall low risk of bias"))))),
reporting_bias=ifelse(k_prop==1 & k_possible==1, "1 eligible study with usable data",
ifelse(k_prop==1 & k_possible>1, paste0("All eligible studies had usable data"),
ifelse(k_prop<1, paste0(round(100*k_prop,1), "% of eligible studies and ", round(100*n_prop,1),"% of participants had usable data"), NA))),
indirectness=ifelse(outcome_type=="efficacy", "No clear indication of indirectness",
ifelse(k_schiz_prop==1, "No clear indication of indirectness",
paste0(round(100*k_schiz_prop,1), "% studies and ", round(100*n_schiz_prop,1), "% participants with schizophrenia")))) %>%
mutate(population=ifelse(outcome_type=="efficacy", population, NA),
id_outcome_population=paste0(outcome, population))  %>%
left_join(outcome_names)  %>%
select(comparison, outcome_type, id_outcome_population, order, outcome_new, population, timepoint, duration, association, study_limitations, reporting_bias, indirectness) %>%
mutate(outcome_new=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", "Positive symptoms (SAPS-PD)", #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", "Overall symptoms (NPI)",
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", "Cognitive impairment (MMSE)",
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", "Response to treatment (≥50% in SAPS-PD)", outcome_new))))) %>%
mutate(order=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", 3, #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", 1,
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", 6,
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", 2, order))))) %>%
mutate(comparison_order=ifelse(comparison=="taar1_vs_placebo",1,2),
population_order=ifelse(population=="Schizophrenia spectrum", 1,
ifelse(population=="Parkinson Disease Psychosis", 2, 3)),
time_order=ifelse(timepoint=="3-13 weeks",1,2)) %>%
mutate(text_comparison=ifelse("taar1_vs_placebo", paste0('TAAR1 agonists vs. placebo', "TAAR1 agonists vs. antipsychotics"))) %>%
mutate(text_population=ifelse(population=="Schizophrenia spectrum","adults with schizophrenia",
ifelse(population=="Parkinson Disease Psychosis", "Parkinson's disease psyschosis", "any eligible population"))) %>%
mutate(text_description=paste0(text_comparison," in ", text_population)) %>%
mutate(other_bias=ifelse(id_outcome_population=="overallSchizophrenia spectrum" | id_outcome_population=="responseSchizophrenia spectrum", "Two phase III trials conducted during COVID-19, which could be associated with factors assocaited with increased placebo effects and smaller effect sizes", "No clear indication of other biases"))
meta_outcome_soe<-meta_outcome_soe[order(meta_outcome_soe$comparison_order, meta_outcome_soe$order, meta_outcome_soe$population_order, meta_outcome_soe$time_order),]
meta_outcome_soe<-meta_outcome_soe %>% select(text_description, outcome_new, duration, association, study_limitations, reporting_bias, indirectness, other_bias)
view(meta_outcome_soe)
meta_outcome_soe<-meta_outcome %>%
mutate(TE=ifelse(outcome=="serious" | outcome=="death", TE.fixed, TE.random),
seTE=ifelse(outcome=="serious" | outcome=="death", seTE.fixed, seTE.random),
TE.placebo=ifelse(outcome=="serious" | outcome=="death", TE.placebo.fixed, TE.placebo.random),
duration=ifelse(duration=="0.14-0.14", "1 day",
ifelse(duration=="0.14-2", "1 day to 2 weeks",
ifelse(duration=="4-4", "4 weeks",
ifelse(duration=="4-6", "4-6 weeks",
ifelse(duration=="6-6", "6 weeks", NA)))))) %>%
mutate(outcome_type=ifelse(outcome %in% effic_outcomes, "efficacy", "other")) %>%
mutate(n_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 100,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 626,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1383,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 39,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 128,1550)))))) %>% #Added the negative symptom study too
mutate(k_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 2,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 12,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 4,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 1,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1,6)))))) %>%
mutate(k_prop=k/k_possible,
n_prop=ifelse(k_prop==1, 1, n/n_possible),
k_schiz_prop=k_schiz/k, n_schiz_prop=n_schiz/n,
moderate_to_high_bias_prop=(moderate_bias+high_bias)/k) %>%
mutate(TE_lb=TE-1.96*seTE,
TE_ub=TE+1.96*seTE) %>%
mutate(cer_point=exp(TE.placebo)/(1+exp(TE.placebo))) %>%
mutate(point=ifelse(sm=="OR", round(exp(TE), 2), round(TE, 2)),
lb=ifelse(sm=="OR", round(exp(TE_lb), 2), round(TE_lb, 2)),
ub=ifelse(sm=="OR", round(exp(TE_ub), 2), round(TE_ub, 2))) %>%
mutate(ACR=ifelse(sm=="OR", round(100*point*cer_point/(1-cer_point+point*cer_point),1), NA),
CER=ifelse(!is.na(point), round(100*cer_point, 1), NA),
t2=round(tau2,4)) %>%
mutate(association=ifelse(!is.na(point),
ifelse(k>1 & !is.na(t2), ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2)),
ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub))),
paste0("N=", k, " n=", n, "; not estimable effect size 0 events in both arms")),
study_limitations=ifelse(moderate_to_high_bias_prop==0 & k==1, "1 study with an overall low risk of bias",
ifelse(moderate_bias==1 & k==1, "1 study with overall some concerns in risk of bias",
ifelse(high_bias==1 & k==1, "1 study with overall high risk of bias",
ifelse(moderate_to_high_bias_prop==0 & k>1, " All studies had overall low risk of bias",
paste0(round(100*(1-moderate_to_high_bias_prop),1),"% had overall low risk of bias"))))),
reporting_bias=ifelse(k_prop==1 & k_possible==1, "1 eligible study with usable data",
ifelse(k_prop==1 & k_possible>1, paste0("All eligible studies had usable data"),
ifelse(k_prop<1, paste0(round(100*k_prop,1), "% of eligible studies and ", round(100*n_prop,1),"% of participants had usable data"), NA))),
indirectness=ifelse(outcome_type=="efficacy", "No clear indication of indirectness",
ifelse(k_schiz_prop==1, "No clear indication of indirectness",
paste0(round(100*k_schiz_prop,1), "% studies and ", round(100*n_schiz_prop,1), "% participants with schizophrenia")))) %>%
mutate(population=ifelse(outcome_type=="efficacy", population, NA),
id_outcome_population=paste0(outcome, population))  %>%
left_join(outcome_names)  %>%
select(comparison, outcome_type, id_outcome_population, order, outcome_new, population, timepoint, duration, association, study_limitations, reporting_bias, indirectness) %>%
mutate(outcome_new=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", "Positive symptoms (SAPS-PD)", #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", "Overall symptoms (NPI)",
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", "Cognitive impairment (MMSE)",
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", "Response to treatment (≥50% in SAPS-PD)", outcome_new))))) %>%
mutate(order=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", 3, #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", 1,
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", 6,
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", 2, order))))) %>%
mutate(comparison_order=ifelse(comparison=="taar1_vs_placebo",1,2),
population_order=ifelse(population=="Schizophrenia spectrum", 1,
ifelse(population=="Parkinson Disease Psychosis", 2, 3)),
time_order=ifelse(timepoint=="3-13 weeks",1,2)) %>%
mutate(text_comparison=ifelse("taar1_vs_placebo", paste0('TAAR1 agonists vs. placebo'), "TAAR1 agonists vs. antipsychotics"))) %>%
meta_outcome_soe<-meta_outcome %>%
mutate(TE=ifelse(outcome=="serious" | outcome=="death", TE.fixed, TE.random),
seTE=ifelse(outcome=="serious" | outcome=="death", seTE.fixed, seTE.random),
TE.placebo=ifelse(outcome=="serious" | outcome=="death", TE.placebo.fixed, TE.placebo.random),
duration=ifelse(duration=="0.14-0.14", "1 day",
ifelse(duration=="0.14-2", "1 day to 2 weeks",
ifelse(duration=="4-4", "4 weeks",
ifelse(duration=="4-6", "4-6 weeks",
ifelse(duration=="6-6", "6 weeks", NA)))))) %>%
mutate(outcome_type=ifelse(outcome %in% effic_outcomes, "efficacy", "other")) %>%
mutate(n_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 100,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 626,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1383,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 39,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 128,1550)))))) %>% #Added the negative symptom study too
mutate(k_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 2,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 12,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 4,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 1,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1,6)))))) %>%
mutate(k_prop=k/k_possible,
n_prop=ifelse(k_prop==1, 1, n/n_possible),
k_schiz_prop=k_schiz/k, n_schiz_prop=n_schiz/n,
moderate_to_high_bias_prop=(moderate_bias+high_bias)/k) %>%
mutate(TE_lb=TE-1.96*seTE,
TE_ub=TE+1.96*seTE) %>%
mutate(cer_point=exp(TE.placebo)/(1+exp(TE.placebo))) %>%
mutate(point=ifelse(sm=="OR", round(exp(TE), 2), round(TE, 2)),
lb=ifelse(sm=="OR", round(exp(TE_lb), 2), round(TE_lb, 2)),
ub=ifelse(sm=="OR", round(exp(TE_ub), 2), round(TE_ub, 2))) %>%
mutate(ACR=ifelse(sm=="OR", round(100*point*cer_point/(1-cer_point+point*cer_point),1), NA),
CER=ifelse(!is.na(point), round(100*cer_point, 1), NA),
t2=round(tau2,4)) %>%
mutate(association=ifelse(!is.na(point),
ifelse(k>1 & !is.na(t2), ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2)),
ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub))),
paste0("N=", k, " n=", n, "; not estimable effect size 0 events in both arms")),
study_limitations=ifelse(moderate_to_high_bias_prop==0 & k==1, "1 study with an overall low risk of bias",
ifelse(moderate_bias==1 & k==1, "1 study with overall some concerns in risk of bias",
ifelse(high_bias==1 & k==1, "1 study with overall high risk of bias",
ifelse(moderate_to_high_bias_prop==0 & k>1, " All studies had overall low risk of bias",
paste0(round(100*(1-moderate_to_high_bias_prop),1),"% had overall low risk of bias"))))),
reporting_bias=ifelse(k_prop==1 & k_possible==1, "1 eligible study with usable data",
ifelse(k_prop==1 & k_possible>1, paste0("All eligible studies had usable data"),
ifelse(k_prop<1, paste0(round(100*k_prop,1), "% of eligible studies and ", round(100*n_prop,1),"% of participants had usable data"), NA))),
indirectness=ifelse(outcome_type=="efficacy", "No clear indication of indirectness",
ifelse(k_schiz_prop==1, "No clear indication of indirectness",
paste0(round(100*k_schiz_prop,1), "% studies and ", round(100*n_schiz_prop,1), "% participants with schizophrenia")))) %>%
mutate(population=ifelse(outcome_type=="efficacy", population, NA),
id_outcome_population=paste0(outcome, population))  %>%
left_join(outcome_names)  %>%
select(comparison, outcome_type, id_outcome_population, order, outcome_new, population, timepoint, duration, association, study_limitations, reporting_bias, indirectness) %>%
mutate(outcome_new=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", "Positive symptoms (SAPS-PD)", #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", "Overall symptoms (NPI)",
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", "Cognitive impairment (MMSE)",
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", "Response to treatment (≥50% in SAPS-PD)", outcome_new))))) %>%
mutate(order=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", 3, #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", 1,
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", 6,
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", 2, order))))) %>%
mutate(comparison_order=ifelse(comparison=="taar1_vs_placebo",1,2),
population_order=ifelse(population=="Schizophrenia spectrum", 1,
ifelse(population=="Parkinson Disease Psychosis", 2, 3)),
time_order=ifelse(timepoint=="3-13 weeks",1,2)) %>%
mutate(text_comparison=ifelse("taar1_vs_placebo", paste0('TAAR1 agonists vs. placebo'), "TAAR1 agonists vs. antipsychotics")) %>%
mutate(text_population=ifelse(population=="Schizophrenia spectrum","adults with schizophrenia",
ifelse(population=="Parkinson Disease Psychosis", "Parkinson's disease psyschosis", "any eligible population"))) %>%
mutate(text_description=paste0(text_comparison," in ", text_population)) %>%
mutate(other_bias=ifelse(id_outcome_population=="overallSchizophrenia spectrum" | id_outcome_population=="responseSchizophrenia spectrum", "Two phase III trials conducted during COVID-19, which could be associated with factors assocaited with increased placebo effects and smaller effect sizes", "No clear indication of other biases"))
meta_outcome_soe<-meta_outcome_soe[order(meta_outcome_soe$comparison_order, meta_outcome_soe$order, meta_outcome_soe$population_order, meta_outcome_soe$time_order),]
meta_outcome_soe<-meta_outcome_soe %>% select(text_description, outcome_new, duration, association, study_limitations, reporting_bias, indirectness, other_bias)
view(meta_outcome_soe)
meta_outcome_soe<-meta_outcome %>%
mutate(TE=ifelse(outcome=="serious" | outcome=="death", TE.fixed, TE.random),
seTE=ifelse(outcome=="serious" | outcome=="death", seTE.fixed, seTE.random),
TE.placebo=ifelse(outcome=="serious" | outcome=="death", TE.placebo.fixed, TE.placebo.random),
duration=ifelse(duration=="0.14-0.14", "1 day",
ifelse(duration=="0.14-2", "1 day to 2 weeks",
ifelse(duration=="4-4", "4 weeks",
ifelse(duration=="4-6", "4-6 weeks",
ifelse(duration=="6-6", "6 weeks", NA)))))) %>%
mutate(outcome_type=ifelse(outcome %in% effic_outcomes, "efficacy", "other")) %>%
mutate(n_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 100,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 626,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1383,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 39,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 128,1550)))))) %>% #Added the negative symptom study too
mutate(k_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 2,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 12,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 4,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 1,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1,6)))))) %>%
mutate(k_prop=k/k_possible,
n_prop=ifelse(k_prop==1, 1, n/n_possible),
k_schiz_prop=k_schiz/k, n_schiz_prop=n_schiz/n,
moderate_to_high_bias_prop=(moderate_bias+high_bias)/k) %>%
mutate(TE_lb=TE-1.96*seTE,
TE_ub=TE+1.96*seTE) %>%
mutate(cer_point=exp(TE.placebo)/(1+exp(TE.placebo))) %>%
mutate(point=ifelse(sm=="OR", round(exp(TE), 2), round(TE, 2)),
lb=ifelse(sm=="OR", round(exp(TE_lb), 2), round(TE_lb, 2)),
ub=ifelse(sm=="OR", round(exp(TE_ub), 2), round(TE_ub, 2))) %>%
mutate(ACR=ifelse(sm=="OR", round(100*point*cer_point/(1-cer_point+point*cer_point),1), NA),
CER=ifelse(!is.na(point), round(100*cer_point, 1), NA),
t2=round(tau2,4)) %>%
mutate(association=ifelse(!is.na(point),
ifelse(k>1 & !is.na(t2), ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2)),
ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub))),
paste0("N=", k, " n=", n, "; not estimable effect size 0 events in both arms")),
study_limitations=ifelse(moderate_to_high_bias_prop==0 & k==1, "1 study with an overall low risk of bias",
ifelse(moderate_bias==1 & k==1, "1 study with overall some concerns in risk of bias",
ifelse(high_bias==1 & k==1, "1 study with overall high risk of bias",
ifelse(moderate_to_high_bias_prop==0 & k>1, " All studies had overall low risk of bias",
paste0(round(100*(1-moderate_to_high_bias_prop),1),"% had overall low risk of bias"))))),
reporting_bias=ifelse(k_prop==1 & k_possible==1, "1 eligible study with usable data",
ifelse(k_prop==1 & k_possible>1, paste0("All eligible studies had usable data"),
ifelse(k_prop<1, paste0(round(100*k_prop,1), "% of eligible studies and ", round(100*n_prop,1),"% of participants had usable data"), NA))),
indirectness=ifelse(outcome_type=="efficacy", "No clear indication of indirectness",
ifelse(k_schiz_prop==1, "No clear indication of indirectness",
paste0(round(100*k_schiz_prop,1), "% studies and ", round(100*n_schiz_prop,1), "% participants with schizophrenia")))) %>%
mutate(population=ifelse(outcome_type=="efficacy", population, NA),
id_outcome_population=paste0(outcome, population))  %>%
left_join(outcome_names)  %>%
select(comparison, outcome_type, id_outcome_population, order, outcome_new, population, timepoint, duration, association, study_limitations, reporting_bias, indirectness) %>%
mutate(outcome_new=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", "Positive symptoms (SAPS-PD)", #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", "Overall symptoms (NPI)",
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", "Cognitive impairment (MMSE)",
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", "Response to treatment (≥50% in SAPS-PD)", outcome_new))))) %>%
mutate(order=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", 3, #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", 1,
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", 6,
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", 2, order))))) %>%
mutate(comparison_order=ifelse(comparison=="taar1_vs_placebo",1,2),
population_order=ifelse(population=="Schizophrenia spectrum", 1,
ifelse(population=="Parkinson Disease Psychosis", 2, 3)),
time_order=ifelse(timepoint=="3-13 weeks",1,2)) %>%
mutate(text_comparison=ifelse("taar1_vs_placebo", paste0('TAAR1 agonists vs. placebo'), "TAAR1 agonists vs. antipsychotics")) %>%
mutate(text_population=ifelse(is.na(population), "any eligible population",
ifelse(population=="Schizophrenia spectrum","adults with schizophrenia","Parkinson Disease Psychosis"))) %>%
mutate(text_description=paste0(text_comparison," in ", text_population)) %>%
mutate(other_bias=ifelse(id_outcome_population=="overallSchizophrenia spectrum" | id_outcome_population=="responseSchizophrenia spectrum", "Two phase III trials conducted during COVID-19, which could be associated with factors assocaited with increased placebo effects and smaller effect sizes", "No clear indication of other biases"))
meta_outcome_soe<-meta_outcome_soe[order(meta_outcome_soe$comparison_order, meta_outcome_soe$order, meta_outcome_soe$population_order, meta_outcome_soe$time_order),]
meta_outcome_soe<-meta_outcome_soe %>% select(text_description, outcome_new, duration, association, study_limitations, reporting_bias, indirectness, other_bias)
view(meta_outcome_soe)
meta_outcome_soe<-meta_outcome %>%
mutate(TE=ifelse(outcome=="serious" | outcome=="death", TE.fixed, TE.random),
seTE=ifelse(outcome=="serious" | outcome=="death", seTE.fixed, seTE.random),
TE.placebo=ifelse(outcome=="serious" | outcome=="death", TE.placebo.fixed, TE.placebo.random),
duration=ifelse(duration=="0.14-0.14", "1 day",
ifelse(duration=="0.14-2", "1 day to 2 weeks",
ifelse(duration=="4-4", "4 weeks",
ifelse(duration=="4-6", "4-6 weeks",
ifelse(duration=="6-6", "6 weeks", NA)))))) %>%
mutate(outcome_type=ifelse(outcome %in% effic_outcomes, "efficacy", "other")) %>%
mutate(n_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 100,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 626,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1383,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 39,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 128,1550)))))) %>% #Added the negative symptom study too
mutate(k_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 2,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 12,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 4,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 1,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1,6)))))) %>%
mutate(k_prop=k/k_possible,
n_prop=ifelse(k_prop==1, 1, n/n_possible),
k_schiz_prop=k_schiz/k, n_schiz_prop=n_schiz/n,
moderate_to_high_bias_prop=(moderate_bias+high_bias)/k) %>%
mutate(TE_lb=TE-1.96*seTE,
TE_ub=TE+1.96*seTE) %>%
mutate(cer_point=exp(TE.placebo)/(1+exp(TE.placebo))) %>%
mutate(point=ifelse(sm=="OR", round(exp(TE), 2), round(TE, 2)),
lb=ifelse(sm=="OR", round(exp(TE_lb), 2), round(TE_lb, 2)),
ub=ifelse(sm=="OR", round(exp(TE_ub), 2), round(TE_ub, 2))) %>%
mutate(ACR=ifelse(sm=="OR", round(100*point*cer_point/(1-cer_point+point*cer_point),1), NA),
CER=ifelse(!is.na(point), round(100*cer_point, 1), NA),
t2=round(tau2,4)) %>%
mutate(association=ifelse(!is.na(point),
ifelse(k>1 & !is.na(t2), ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2)),
ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub))),
paste0("N=", k, " n=", n, "; not estimable effect size 0 events in both arms")),
study_limitations=ifelse(moderate_to_high_bias_prop==0 & k==1, "1 study with an overall low risk of bias",
ifelse(moderate_bias==1 & k==1, "1 study with overall some concerns in risk of bias",
ifelse(high_bias==1 & k==1, "1 study with overall high risk of bias",
ifelse(moderate_to_high_bias_prop==0 & k>1, " All studies had overall low risk of bias",
paste0(round(100*(1-moderate_to_high_bias_prop),1),"% had overall low risk of bias"))))),
reporting_bias=ifelse(k_prop==1 & k_possible==1, "1 eligible study with usable data",
ifelse(k_prop==1 & k_possible>1, paste0("All eligible studies had usable data"),
ifelse(k_prop<1, paste0(round(100*k_prop,1), "% of eligible studies and ", round(100*n_prop,1),"% of participants had usable data"), NA))),
indirectness=ifelse(outcome_type=="efficacy", "No clear indication of indirectness",
ifelse(k_schiz_prop==1, "No clear indication of indirectness",
paste0(round(100*k_schiz_prop,1), "% studies and ", round(100*n_schiz_prop,1), "% participants with schizophrenia")))) %>%
mutate(population=ifelse(outcome_type=="efficacy", population, NA),
id_outcome_population=paste0(outcome, population))  %>%
left_join(outcome_names)  %>%
select(comparison, outcome_type, id_outcome_population, order, outcome_new, population, timepoint, duration, association, study_limitations, reporting_bias, indirectness) %>%
mutate(outcome_new=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", "Positive symptoms (SAPS-PD)", #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", "Overall symptoms (NPI)",
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", "Cognitive impairment (MMSE)",
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", "Response to treatment (≥50% in SAPS-PD)", outcome_new))))) %>%
mutate(order=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", 3, #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", 1,
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", 6,
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", 2, order))))) %>%
mutate(comparison_order=ifelse(comparison=="taar1_vs_placebo",1,2),
population_order=ifelse(population=="Schizophrenia spectrum", 1,
ifelse(population=="Parkinson Disease Psychosis", 2, 3)),
time_order=ifelse(timepoint=="3-13 weeks",1,2)) %>%
mutate(text_comparison=ifelse(comparison=="taar1_vs_placebo", paste0('TAAR1 agonists vs. placebo'), "TAAR1 agonists vs. antipsychotics")) %>%
mutate(text_population=ifelse(is.na(population), "any eligible population",
ifelse(population=="Schizophrenia spectrum","adults with schizophrenia","Parkinson Disease Psychosis"))) %>%
mutate(text_description=paste0(text_comparison," in ", text_population)) %>%
mutate(other_bias=ifelse(id_outcome_population=="overallSchizophrenia spectrum" | id_outcome_population=="responseSchizophrenia spectrum", "Two phase III trials conducted during COVID-19, which could be associated with factors assocaited with increased placebo effects and smaller effect sizes", "No clear indication of other biases"))
meta_outcome_soe<-meta_outcome_soe[order(meta_outcome_soe$comparison_order, meta_outcome_soe$order, meta_outcome_soe$population_order, meta_outcome_soe$time_order),]
meta_outcome_soe<-meta_outcome_soe %>% select(text_description, outcome_new, duration, association, study_limitations, reporting_bias, indirectness, other_bias)
view(meta_outcome_soe)
knitr::kable(meta_outcome_soe[, 1:8])
meta_outcome_soe<-meta_outcome %>%
mutate(TE=ifelse(outcome=="serious" | outcome=="death", TE.fixed, TE.random),
seTE=ifelse(outcome=="serious" | outcome=="death", seTE.fixed, seTE.random),
TE.placebo=ifelse(outcome=="serious" | outcome=="death", TE.placebo.fixed, TE.placebo.random),
duration=ifelse(duration=="0.14-0.14", "1 day",
ifelse(duration=="0.14-2", "1 day to 2 weeks",
ifelse(duration=="4-4", "4 weeks",
ifelse(duration=="4-6", "4-6 weeks",
ifelse(duration=="6-6", "6 weeks", NA)))))) %>%
mutate(outcome_type=ifelse(outcome %in% effic_outcomes, "efficacy", "other")) %>%
mutate(n_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 100,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 626,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1383,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 39,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 128,1550)))))) %>% #Added the negative symptom study too
mutate(k_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 2,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 12,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 4,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 1,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1,6)))))) %>%
mutate(k_prop=k/k_possible,
n_prop=ifelse(k_prop==1, 1, n/n_possible),
k_schiz_prop=k_schiz/k, n_schiz_prop=n_schiz/n,
moderate_to_high_bias_prop=(moderate_bias+high_bias)/k) %>%
mutate(TE_lb=TE-1.96*seTE,
TE_ub=TE+1.96*seTE) %>%
mutate(cer_point=exp(TE.placebo)/(1+exp(TE.placebo))) %>%
mutate(point=ifelse(sm=="OR", round(exp(TE), 2), round(TE, 2)),
lb=ifelse(sm=="OR", round(exp(TE_lb), 2), round(TE_lb, 2)),
ub=ifelse(sm=="OR", round(exp(TE_ub), 2), round(TE_ub, 2))) %>%
mutate(ACR=ifelse(sm=="OR", round(100*point*cer_point/(1-cer_point+point*cer_point),1), NA),
CER=ifelse(!is.na(point), round(100*cer_point, 1), NA),
t2=round(tau2,4)) %>%
mutate(association=ifelse(!is.na(point),
ifelse(k>1 & !is.na(t2), ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2)),
ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub))),
paste0("N=", k, " n=", n, "; not estimable effect size 0 events in both arms")),
study_limitations=ifelse(moderate_to_high_bias_prop==0 & k==1, "1 study with an overall low risk of bias",
ifelse(moderate_bias==1 & k==1, "1 study with overall some concerns in risk of bias",
ifelse(high_bias==1 & k==1, "1 study with overall high risk of bias",
ifelse(moderate_to_high_bias_prop==0 & k>1, " All studies had overall low risk of bias",
paste0(round(100*(1-moderate_to_high_bias_prop),1),"% had overall low risk of bias"))))),
reporting_bias=ifelse(k_prop==1 & k_possible==1, "1 eligible study with usable data",
ifelse(k_prop==1 & k_possible>1, paste0("All eligible studies had usable data"),
ifelse(k_prop<1, paste0(round(100*k_prop,1), "% of eligible studies and ", round(100*n_prop,1),"% of participants had usable data"), NA))),
indirectness=ifelse(outcome_type=="efficacy", "No clear indication of indirectness",
ifelse(k_schiz_prop==1, "No clear indication of indirectness",
paste0(round(100*k_schiz_prop,1), "% studies and ", round(100*n_schiz_prop,1), "% participants with schizophrenia")))) %>%
mutate(population=ifelse(outcome_type=="efficacy", population, NA),
id_outcome_population=paste0(outcome, population))  %>%
left_join(outcome_names)  %>%
select(comparison, outcome_type, id_outcome_population, order, outcome_new, population, timepoint, duration, association, study_limitations, reporting_bias, indirectness) %>%
mutate(outcome_new=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", "Positive symptoms (SAPS-PD)", #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", "Overall symptoms (NPI)",
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", "Cognitive impairment (MMSE)",
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", "Response to treatment (≥50% in SAPS-PD)", outcome_new))))) %>%
mutate(order=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", 3, #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", 1,
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", 6,
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", 2, order))))) %>%
mutate(comparison_order=ifelse(comparison=="taar1_vs_placebo",1,2),
population_order=ifelse(population=="Schizophrenia spectrum", 1,
ifelse(population=="Parkinson Disease Psychosis", 2, 3)),
time_order=ifelse(timepoint=="3-13 weeks",1,2)) %>%
mutate(text_comparison=ifelse(comparison=="taar1_vs_placebo", paste0('TAAR1 agonists vs. placebo'), "TAAR1 agonists vs. antipsychotics")) %>%
mutate(text_population=ifelse(is.na(population), "any eligible population",
ifelse(population=="Schizophrenia spectrum","adults with schizophrenia","Parkinson Disease Psychosis"))) %>%
mutate(text_description=paste0(text_comparison," in ", text_population)) %>%
mutate(other_bias=ifelse(comparison=="taar1_vs_placebo " & (id_outcome_population=="overallSchizophrenia spectrum" | id_outcome_population=="responseSchizophrenia spectrum"),
"Two phase III trials conducted during COVID-19, which could be associated with factors assocaited with increased placebo effects and smaller effect sizes", "No clear indication of other biases"))
view(meta_outocme_soe)
view(meta_outcome_soe)
meta_outcome_soe<-meta_outcome %>%
mutate(TE=ifelse(outcome=="serious" | outcome=="death", TE.fixed, TE.random),
seTE=ifelse(outcome=="serious" | outcome=="death", seTE.fixed, seTE.random),
TE.placebo=ifelse(outcome=="serious" | outcome=="death", TE.placebo.fixed, TE.placebo.random),
duration=ifelse(duration=="0.14-0.14", "1 day",
ifelse(duration=="0.14-2", "1 day to 2 weeks",
ifelse(duration=="4-4", "4 weeks",
ifelse(duration=="4-6", "4-6 weeks",
ifelse(duration=="6-6", "6 weeks", NA)))))) %>%
mutate(outcome_type=ifelse(outcome %in% effic_outcomes, "efficacy", "other")) %>%
mutate(n_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 100,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 626,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1383,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 39,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 128,1550)))))) %>% #Added the negative symptom study too
mutate(k_possible=ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_antipsychotic", 2,
ifelse(timepoint=="1 day-2 weeks" & comparison=="taar1_vs_placebo", 12,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 4,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_placebo" & outcome_type=="efficacy" & population=="Parkinson Disease Psychosis", 1,
ifelse(timepoint=="3-13 weeks" & comparison=="taar1_vs_antipsychotic" & outcome_type=="efficacy" & population=="Schizophrenia spectrum", 1,6)))))) %>%
mutate(k_prop=k/k_possible,
n_prop=ifelse(k_prop==1, 1, n/n_possible),
k_schiz_prop=k_schiz/k, n_schiz_prop=n_schiz/n,
moderate_to_high_bias_prop=(moderate_bias+high_bias)/k) %>%
mutate(TE_lb=TE-1.96*seTE,
TE_ub=TE+1.96*seTE) %>%
mutate(cer_point=exp(TE.placebo)/(1+exp(TE.placebo))) %>%
mutate(point=ifelse(sm=="OR", round(exp(TE), 2), round(TE, 2)),
lb=ifelse(sm=="OR", round(exp(TE_lb), 2), round(TE_lb, 2)),
ub=ifelse(sm=="OR", round(exp(TE_ub), 2), round(TE_ub, 2))) %>%
mutate(ACR=ifelse(sm=="OR", round(100*point*cer_point/(1-cer_point+point*cer_point),1), NA),
CER=ifelse(!is.na(point), round(100*cer_point, 1), NA),
t2=round(tau2,4)) %>%
mutate(association=ifelse(!is.na(point),
ifelse(k>1 & !is.na(t2), ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub,"; tau2=", t2)),
ifelse(sm=="OR", paste0("N=", k, " n=", n, "; ", ACR,"% vs. ", CER,"%, ", sm,"=",point,", 95%CI: ", lb, ", ", ub),
paste0("N=", k, " n=", n, "; ", sm,"=",point,", 95%CI: ", lb, ", ", ub))),
paste0("N=", k, " n=", n, "; not estimable effect size 0 events in both arms")),
study_limitations=ifelse(moderate_to_high_bias_prop==0 & k==1, "1 study with an overall low risk of bias",
ifelse(moderate_bias==1 & k==1, "1 study with overall some concerns in risk of bias",
ifelse(high_bias==1 & k==1, "1 study with overall high risk of bias",
ifelse(moderate_to_high_bias_prop==0 & k>1, " All studies had overall low risk of bias",
paste0(round(100*(1-moderate_to_high_bias_prop),1),"% had overall low risk of bias"))))),
reporting_bias=ifelse(k_prop==1 & k_possible==1, "1 eligible study with usable data",
ifelse(k_prop==1 & k_possible>1, paste0("All eligible studies had usable data"),
ifelse(k_prop<1, paste0(round(100*k_prop,1), "% of eligible studies and ", round(100*n_prop,1),"% of participants had usable data"), NA))),
indirectness=ifelse(outcome_type=="efficacy", "No clear indication of indirectness",
ifelse(k_schiz_prop==1, "No clear indication of indirectness",
paste0(round(100*k_schiz_prop,1), "% studies and ", round(100*n_schiz_prop,1), "% participants with schizophrenia")))) %>%
mutate(population=ifelse(outcome_type=="efficacy", population, NA),
id_outcome_population=paste0(outcome, population))  %>%
left_join(outcome_names)  %>%
select(comparison, outcome_type, id_outcome_population, order, outcome_new, population, timepoint, duration, association, study_limitations, reporting_bias, indirectness) %>%
mutate(outcome_new=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", "Positive symptoms (SAPS-PD)", #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", "Overall symptoms (NPI)",
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", "Cognitive impairment (MMSE)",
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", "Response to treatment (≥50% in SAPS-PD)", outcome_new))))) %>%
mutate(order=ifelse(id_outcome_population=="positiveParkinson Disease Psychosis", 3, #Manually add some variables that were not added before
ifelse(id_outcome_population=="overallParkinson Disease Psychosis", 1,
ifelse(id_outcome_population=="cognitionParkinson Disease Psychosis", 6,
ifelse(id_outcome_population=="responseParkinson Disease Psychosis", 2, order))))) %>%
mutate(comparison_order=ifelse(comparison=="taar1_vs_placebo",1,2),
population_order=ifelse(population=="Schizophrenia spectrum", 1,
ifelse(population=="Parkinson Disease Psychosis", 2, 3)),
time_order=ifelse(timepoint=="3-13 weeks",1,2)) %>%
mutate(text_comparison=ifelse(comparison=="taar1_vs_placebo", paste0('TAAR1 agonists vs. placebo'), "TAAR1 agonists vs. antipsychotics")) %>%
mutate(text_population=ifelse(is.na(population), "any eligible population",
ifelse(population=="Schizophrenia spectrum","adults with schizophrenia","Parkinson Disease Psychosis"))) %>%
mutate(text_description=paste0(text_comparison," in ", text_population)) %>%
mutate(other_bias=ifelse(comparison=="taar1_vs_placebo" & (id_outcome_population=="overallSchizophrenia spectrum" | id_outcome_population=="responseSchizophrenia spectrum"),
"Two phase III trials conducted during COVID-19, which could be associated with factors assocaited with increased placebo effects and smaller effect sizes", "No clear indication of other biases"))
view(meta_outcome_soe)
